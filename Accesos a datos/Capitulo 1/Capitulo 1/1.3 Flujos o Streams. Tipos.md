[[Manejo de ficheros]]

---
#### FLUJOS O STREAMS. TIPOS

El **sistema de entrada/salida en Java** está compuesto por diversas clases que forman parte del paquete `java.io`. Estas clases utilizan la abstracción del **flujo (stream)** para gestionar la **comunicación de información** entre una fuente y un destino. Esta información puede proceder de varias fuentes:

- Archivos en el **disco duro**
- **Memoria**
- **Red** o
- **Otro programa**

#### Funcionamiento de los Streams

- **Streams de entrada**: Se utilizan para leer información de una fuente.
- **Streams de salida**: Se utilizan para escribir información en un destino.

Cualquier programa que necesite **obtener información** de una fuente abrirá un **stream de entrada**, mientras que para **enviar información** abrirá un **stream de salida**, escribiendo los datos de forma **serial** (uno tras otro).

La **vinculación del stream** al dispositivo físico (como un archivo o la red) se gestiona automáticamente mediante el sistema de entrada y salida de Java.

#### Tipos de Flujos:

1. **Flujos de bytes (8 bits):**
    
    - Realizan operaciones de entrada/salida de **bytes**.
    - Su uso está orientado a la lectura y escritura de **datos binarios**.
    - Todas las clases de flujos de bytes descienden de las clases:
        - `InputStream` (para la lectura)
        - `OutputStream` (para la escritura)
    - Estas clases tienen varias **subclases** que manejan las diferencias entre los distintos dispositivos de entrada/salida (como archivos, redes, etc.).
2. **Flujos de caracteres (16 bits):**
    
    - Realizan operaciones de entrada/salida de **caracteres**.
    - Son gobernados por las clases:
        - `Reader` (para la lectura)
        - `Writer` (para la escritura)
    - Estas clases son esenciales para la **internacionalización**:
        - La jerarquía de flujos de entrada/salida antigua (basada en 8 bits) no soportaba caracteres **Unicode** de 16 bits, lo que complicaba el soporte de múltiples idiomas.
        - Con los flujos de caracteres, Java mejora la compatibilidad con textos en diversos idiomas, soportando caracteres más complejos y lenguajes no basados en el alfabeto latino.

### Resumen:

- **Flujos de bytes**: Utilizados para datos binarios (8 bits), manejan archivos binarios como imágenes o audio.
- **Flujos de caracteres**: Utilizados para texto y datos Unicode (16 bits), más adecuados para el manejo de texto internacional.

---
#### 1.3.1. Flujos de bytes (Byte Streams)

Los **flujos de bytes** en Java se utilizan para la **lectura** y **escritura** de datos binarios (8 bits) y están representados principalmente por las clases `InputStream` y `OutputStream`. Estas clases manejan **fuentes** como archivos, arrays de bytes, conexiones de red, etc.

### Clases de `InputStream` (Entrada):

La clase `InputStream` representa fuentes de datos que pueden ser leídas. A continuación se muestra una lista de las clases derivadas más comunes de `InputStream`:

|**Clase**|**Función**|
|---|---|
|`ByteArrayInputStream`|Permite usar un espacio de almacenamiento intermedio en memoria.|
|`StringBufferInputStream`|Convierte un `String` en un `InputStream`.|
|`FileInputStream`|Permite leer datos de un archivo en el disco.|
|`PipedInputStream`|Implementa el concepto de "tubería" para la comunicación entre threads.|
|`FilterInputStream`|Añade funcionalidades útiles a otras clases `InputStream`.|
|`SequenceInputStream`|Combina dos o más `InputStream` en un único flujo de entrada.|
**Ejemplo de uso de `FileInputStream`:** Se utiliza para **leer archivos** del disco.
```java
FileInputStream fis = new FileInputStream("archivo.txt");
```

### Clases de `OutputStream` (Salida):

La clase `OutputStream` representa un flujo de datos que puede ser escrito a un destino. A continuación se describen las clases derivadas de `OutputStream` más comunes:

|**Clase**|**Función**|
|---|---|
|`ByteArrayOutputStream`|Crea un espacio intermedio en memoria donde se almacenan los datos.|
|`FileOutputStream`|Envía datos a un archivo en el disco.|
|`PipedOutputStream`|Escribe datos que serán leídos por un `PipedInputStream` asociado.|
|`FilterOutputStream`|Proporciona funcionalidades adicionales a otras clases `OutputStream`.|
**Ejemplo de uso de `FileOutputStream`:** Se utiliza para **escribir archivos** en el disco.

```java
FileOutputStream fos = new FileOutputStream("archivo.txt");
```

### Jerarquía de Clases para Flujos de Bytes:

La **jerarquía** de clases en Java para la **lectura** y **escritura** de flujos de bytes es la siguiente (ver Figura 1.1):

#### Clases de entrada (`InputStream`):

- `FileInputStream`: Lee datos de un archivo.
  
- `PipedInputStream`: Implementa "tuberías" para comunicación entre hilos.
  
- `FilterInputStream`: Añade funcionalidades adicionales.
  
- `DataInputStream`: Lee datos primitivos (enteros, booleanos, etc.).
  
- `ByteArrayInputStream`: Lee bytes desde un array en memoria.
  
- `BufferedInputStream`: Añade un buffer para mejorar el rendimiento.
  
- `SequenceInputStream`: Combina múltiples flujos de entrada.
  
- `PushbackInputStream`: Permite "devolver" datos al flujo para ser leídos de nuevo.

#### Clases de salida (`OutputStream`):

- `FileOutputStream`: Escribe datos a un archivo.
  
- `PipedOutputStream`: Implementa "tuberías" para escritura.
  
- `FilterOutputStream`: Añade funcionalidades adicionales.
  
- `DataOutputStream`: Escribe datos primitivos.
  
- `ByteArrayOutputStream`: Escribe bytes a un array en memoria.
  
- `BufferedOutputStream`: Añade un buffer para escritura eficiente.
  
- `PrintStream`: Imprime datos a un flujo

- `ObjectOutputStream`: Escribe objetos para serialización.

### Resumen:

- Los **flujos de bytes** permiten leer/escribir datos binarios desde/hacia diferentes fuentes y destinos.
  
- Se utilizan las clases **`InputStream`** para la **lectura** y **`OutputStream`** para la **escritura**.
  
- Las subclases más comunes como `FileInputStream` y `FileOutputStream` manejan archivos directamente.
  
- Clases como `PipedInputStream` y `PipedOutputStream` permiten la comunicación entre threads mediante "tuberías".

----

#### 1.3.2. Flujos de caracteres (Character Streams)

En Java, los **flujos de caracteres** manejan datos en formato **Unicode** (16 bits), lo que los hace adecuados para la lectura y escritura de **texto** en distintos idiomas. Las clases clave para los flujos de caracteres son:

- **`Reader`**: Para la **lectura** de caracteres.
- **`Writer`**: Para la **escritura** de caracteres.

#### Clases Puente: Conexión entre Flujos de Bytes y Caracteres

A veces es necesario combinar las clases de **bytes** y **caracteres**. Para ello, Java ofrece clases "puente" que permiten convertir flujos de bytes a flujos de caracteres, o viceversa:

- **`InputStreamReader`**: Convierte un `InputStream` (flujo de bytes) en un `Reader` (flujo de caracteres).
- **`OutputStreamWriter`**: Convierte un `OutputStream` (flujo de bytes) en un `Writer` (flujo de caracteres).

Estas clases permiten trabajar con archivos binarios y textos en el mismo programa, manejando eficientemente los datos de diferentes tipos.

#### Correspondencia entre Clases de Flujos de Bytes y de Caracteres

|**Clases de Flujos de Bytes**|**Clase Correspondiente de Flujos de Caracteres**|
|---|---|
|`InputStream`|`Reader`, convertido con `InputStreamReader`|
|`FileInputStream`|`FileReader`|
|`OutputStream`|`Writer`, convertido con `OutputStreamWriter`|
|`FileOutputStream`|`FileWriter`|
|`ByteArrayInputStream`|`CharArrayReader`|
|`ByteArrayOutputStream`|`CharArrayWriter`|
|`PipedInputStream`|`PipedReader`|
|`PipedOutputStream`|`PipedWriter`|
|`StringBufferInputStream`|No tiene clase correspondiente de flujo de caracteres|

#### Jerarquía de Clases para Flujos de Caracteres

- **Lectura (`Reader`):**
    
    - `BufferedReader`: Añade un buffer para mejorar el rendimiento.
    - `FileReader`: Lee caracteres de un archivo.
    - `CharArrayReader`: Lee caracteres de un array.
    - `InputStreamReader`: Convierte un flujo de bytes en caracteres.
    - `PipedReader`: Implementa una "tubería" para la comunicación entre threads.
    - `PushbackReader`: Permite "devolver" caracteres al flujo.
    - `StringReader`: Lee caracteres de una cadena `String`.
- **Escritura (`Writer`):**
    
    - `BufferedWriter`: Escribe caracteres utilizando un buffer para mayor eficiencia.
    - `FileWriter`: Escribe caracteres en un archivo.
    - `CharArrayWriter`: Escribe caracteres a un array.
    - `OutputStreamWriter`: Convierte caracteres en bytes y los escribe.
    - `PipedWriter`: Implementa una "tubería" para escritura.
    - `PrintWriter`: Escribe texto con formato.
    - `StringWriter`: Escribe caracteres en un objeto `String`.

#### Clases más Importantes para Flujos de Caracteres

1. **`FileReader` y `FileWriter`**:
    
    - Se utilizan para leer y escribir **caracteres** en **archivos** de texto. Ejemplo
      
      ``` java
      FileReader fr = new FileReader("archivo.txt");
FileWriter fw = new FileWriter("archivo.txt");
```

2. **`CharArrayReader` y `CharArrayWriter`**:
    
    - Manejan flujos de caracteres desde/hacia **arrays** de caracteres.
      
3. **`BufferedReader` y `BufferedWriter`**:
    
    - Mejoran la eficiencia mediante el uso de un **buffer intermedio**. Este buffer reduce el número de accesos al archivo, optimizando la lectura y escritura. Ejemplo:
      ```java
      BufferedReader br = new BufferedReader(new FileReader("archivo.txt"));
BufferedWriter bw = new BufferedWriter(new FileWriter("archivo.txt"));
```

### Resumen:

- **Flujos de caracteres** manejan texto (Unicode de 16 bits), en lugar de datos binarios (8 bits).
- Las clases **`Reader`** y **`Writer`** se utilizan para leer y escribir caracteres.
- Existen **clases puente** como `InputStreamReader` y `OutputStreamWriter` para convertir entre flujos de bytes y caracteres.
- Las clases más importantes para trabajar con archivos de texto son **`FileReader`** y **`FileWriter`**, mientras que **`BufferedReader`** y **`BufferedWriter`** mejoran la eficiencia mediante el uso de buffers.