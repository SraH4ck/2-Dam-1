[[Manejo de ficheros]]

----
#### Operaciones sobre Ficheros

Las operaciones más comunes que se realizan sobre ficheros, independientemente de cómo se acceda a ellos (secuencial o aleatorio), incluyen **creación**, **apertura**, **cierre**, **lectura** y **escritura**. Además, hay operaciones adicionales como **altas**, **bajas**, **modificaciones** y **consultas**. A continuación se describe cada una:

---

### Operaciones Básicas

1. **Creación del Fichero**:
    
    - La **creación** de un fichero consiste en asignar un espacio en el disco con un nombre específico que identificará dicho fichero.
    - **Este proceso solo se realiza una vez**, y una vez creado, el fichero puede abrirse y manipularse tantas veces como sea necesario. Ejemplo en Java
      ```java
      File file = new File("archivo.txt");
if (file.createNewFile()) {
    System.out.println("Fichero creado: " + file.getName());
} else {
    System.out.println("El fichero ya existe.");
}

```

2. **Apertura del Fichero**:

- Para poder operar con un fichero, es necesario **abrirlo primero**. Esto se logra identificando el fichero con el que se desea trabajar y asignándolo a una variable.
- En Java, la apertura se realiza al crear un objeto asociado con el fichero, como `FileReader`, `FileWriter`, `RandomAccessFile`, entre otros.
- Ejemplo de apertura para lectura
  ```java
  FileReader fr = new FileReader("archivo.txt");

```

3. **Cierre del Fichero**:

- Después de utilizar un fichero, **se debe cerrar**. Esto libera los recursos asociados al fichero y asegura que cualquier operación pendiente, como escribir datos en el disco, se complete.
- En Java, se utiliza el método `close()` para cerrar el fichero. Ejemplo
  ```java
  fr.close() //Cierra el FileReader
```

4. **Lectura de Datos del Fichero**:

- La lectura consiste en **transferir datos** del fichero a la **memoria principal** del programa, que suele ser gestionada mediante variables.
- Ejemplo de lectura en Java (secuencial)
  ```java
  BufferedReader br = new BufferedReader(new FileReader("archivo.txt"));
String linea;
while ((linea = br.readLine()) != null) {
    System.out.println(linea);  // Procesa cada línea
}
br.close();

```

5. **Escritura de Datos en el Fichero**:

- La escritura consiste en **transferir datos** desde la memoria del programa al fichero. Esto puede ser realizado de forma secuencial o aleatoria. Ejemplo:
  ```java
  BufferedWriter bw = new BufferedWriter(new FileWriter("archivo.txt"));
bw.write("Este es un nuevo dato.");
bw.close();  // Cierra después de escribir
```

### Operaciones Típicas

1. **Altas**:
    
    - Consiste en **añadir un nuevo registro** al fichero. En ficheros secuenciales, los nuevos datos se añaden al final.
    - Ejemplo en Java
      ```java 
      FileWriter fw = new FileWriter("archivo.txt", true);  // "true" permite añadir al final
BufferedWriter bw = new BufferedWriter(fw);
bw.write("Nuevo registro");
bw.close();

```

2. **Bajas**:

- La baja consiste en **eliminar un registro existente** en el fichero.
- **Eliminación lógica**: Se marca el registro como inactivo sin borrarlo físicamente. Puede hacerse cambiando un valor de un campo.
- **Eliminación física**: Se reescribe el fichero eliminando el registro no deseado.
- Ejemplo de eliminación física:
  
```java
File original = new File("archivo.txt");
File temporal = new File("archivo_tmp.txt");
BufferedReader br = new BufferedReader(new FileReader(original));
BufferedWriter bw = new BufferedWriter(new FileWriter(temporal));

String linea;
while ((linea = br.readLine()) != null) {
    if (!linea.contains("registro a eliminar")) {
        bw.write(linea + System.lineSeparator());
    }
}
br.close();
bw.close();
original.delete();
temporal.renameTo(original);  // Renombra temporal al nombre original

```

3. **Modificaciones**:

- La modificación de un registro consiste en **cambiar parte del contenido** de un registro existente. En muchos casos, se requiere localizar el registro y luego reescribirlo. Ejemplo de modificación
  ```java
  RandomAccessFile raf = new RandomAccessFile("archivo.dat", "rw");
raf.seek(100);  // Posiciona en el byte 100
raf.writeUTF("Nuevo contenido");  // Sobrescribe en esa posición
raf.close();

```

4. **Consultas**:

- Consiste en **buscar un registro** dentro del fichero sin modificar su contenido. Esto implica recorrer el fichero hasta encontrar el dato que se desea. Ejemplo:
  ```java
  BufferedReader br = new BufferedReader(new FileReader("archivo.txt"));
String linea;
while ((linea = br.readLine()) != null) {
    if (linea.contains("dato buscado")) {
        System.out.println("Registro encontrado: " + linea);
    }
}
br.close();

```

---
### Resumen de las Operaciones:

- **Creación**: Se realiza una sola vez para inicializar el fichero.
- **Apertura**: Es necesaria antes de cualquier operación de lectura o escritura.
- **Cierre**: Se debe realizar siempre después de usar el fichero para liberar los recursos.
- **Lectura/Escritura**: Operaciones básicas que permiten interactuar con el contenido del fichero.
- **Altas**: Añadir nuevos registros.
- **Bajas**: Eliminar registros, puede ser lógico o físico.
- **Modificaciones**: Actualizar el contenido de un registro existente.
- **Consultas**: Buscar un registro específico sin modificar el fichero.